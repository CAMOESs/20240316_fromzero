import{_ as ce}from"./breadcrumbs.e7037877.js";import{r as c,c as X,b as m,o as U,m as M,w as o,f as n,s as ee,l as V,t as O,e as N,g as _e,A as g,h as a,z as L,j as W,u as te,p as H,i as T,B as oe,d as J,x as G,y as ae,C as re,D as le,k as K,F as ne,q as me}from"./entry.febd1464.js";import{_ as fe}from"./table.665c22b5.js";const be={class:"d-none d-xs-none d-sm-block"},ve={__name:"ButtonDialog",props:["name_of_button","icon_of_button","disabled","selected","width","hidden_close_btn","click_come_to_acess_update"],setup(e){const u=e,f=c(!1),s=c({}),w=c({}),t=c({item_object:w}),k=c({d:f});function b(){}function A(){}async function S(){u.click_come_to_acess_update?await u.click_come_to_acess_update(t,u.selected):Array.isArray(u.selected)&&u.selected.length===1&&({...u.selected[0]},w.value={...u.selected[0]})}const y=X(()=>u.width?u.width:"auto"),B=X(()=>u.hidden_close_btn?!u.hidden_close_btn:!0);return(z,p)=>{const C=m("v-icon"),r=m("v-btn"),j=m("v-spacer"),$=m("v-card-actions"),x=m("v-card"),h=m("v-form"),q=m("v-dialog");return U(),M(q,{modelValue:a(f),"onUpdate:modelValue":p[1]||(p[1]=P=>W(f)?f.value=P:null),persistent:"","max-width":a(y)},{activator:o(({props:P})=>[n(r,ee(P,{class:"mr-1",disabled:e.disabled,style:{color:"white"},color:"#093e73",onClick:S}),{default:o(()=>[n(C,null,{default:o(()=>[V(O(e.icon_of_button),1)]),_:1}),N("span",be,O(e.name_of_button),1)]),_:2},1040,["disabled"])]),default:o(()=>[n(h,{onSubmit:_e(b,["prevent"]),ref_key:"form",ref:s,class:"overflow-y-auto"},{default:o(()=>[n(x,{class:"px-6",style:{width:"300","text-align":"center"}},{default:o(()=>[g(z.$slots,"button_text",{item:a(w)}),n($,null,{default:o(()=>[n(j),a(B)?(U(),M(r,{key:0,color:"secondary",text:"",onClick:p[0]||(p[0]=P=>{f.value=!1}),outlined:""},{default:o(()=>[V(" Fermer ")]),_:1})):L("",!0),g(z.$slots,"button_button",{form:a(s),item:a(w),item_object:a(t),dialog:a(k)})]),_:3})]),_:3})]),_:3},512)]),_:3},8,["modelValue","max-width"])}}},Y=ve;const pe=["value"],ye=["onUpdate:modelValue"],he={class:"d-none d-xs-none d-sm-block"},we=N("br",null,null,-1),ge=N("br",null,null,-1),ke={class:"row mx-3"},xe="",je={__name:"index",props:["title","api","columns","update","add","destroy","destroy_route","add_function","update_function","item_will_be_send","click_come_to_acess_update","destroy_function","id_demande_conge","name_of_button_add","name_of_button_edit","name_of_button_delete","func_controle_disabled_add_button","func_controle_disabled_delete_button","func_controle_disabled_update_button","text_of_validation_on_pop_up_confirm_delete","with_selected"],emits:["update:columns"],async setup(e){var P;let u,f;const s=e,w=c([{}]);c(!1),c(!1),c(10),c(1);const t=c([]),k=c({selected:t});let b=c([]),A=c(!0),S=c({display_table:A}),y=te(),B;const z=c(""),p=c("");if(s.item_will_be_send?(A.value=!1,b.value=[]):(A.value=!0,B=([u,f]=H(()=>T(s.api,"$Uk74EvgyrO")),u=await u,f(),u),b.value=Array.isArray(B.data.value)?B.data.value:[]),!isNaN(parseInt((P=s.id_demande_conge)==null?void 0:P.year_id))){A.value=!0,t.value=[];let l=s.id_demande_conge;s.id_demande_conge.year_id;try{let i=([u,f]=H(()=>T("/api/mes_conges_permissions/",{params:l},"$mJ2zdRK9tZ")),u=await u,f(),u);if(i.error.value)throw new Error(i.error.value);b.value=i.data.value.map(_=>({..._}))}catch{b.value=[]}}function C(){p.value=z.value}oe(async()=>{w.value=s.columns}),c({status:!1,type:"",text:"",timeout:-1});const r=c({items:b});async function j(l){(await l.form.validate()).valid&&(typeof s.add_function=="function"?await s.add_function(l.item,r,k):await x(l.item),l.item_object.item_object={},l.dialog.d=!1)}async function $(l){if(console.log("selected_object"),console.log(k),(await l.form.validate()).valid){typeof s.add_function=="function"?await s.update_function(l.item,r):await h(l.item,r,{item_object:l.item_object});for(const i in r.value.items)r.value.items[i].id==l.item_object.item_object.id&&(t.value=[r.value.items[i]]);l.item_object.item_object={},l.dialog.d=!1}}async function x(l,i){let _,v;try{if(v=await T(s.api,{method:"POST",body:l},"$1Kk6HuOxmX"),console.log("data.data.value.error ==>>>"),console.log(v.data.value.error),v.error.value)throw _=v.error.value,"";if(v.data.value.error)throw"";r.value.items.push(v.data.value),y.success("Enregistrement réussi"),l={}}catch(R){console.error(R),v.data.value.error?y.error(v.data.value.error):y.error("Nous n'avons pas pu effectuer l'opération demandée. Veuillez actualiser la page et réessayer.")}}async function h(l,i){let _;try{let v=await T(s.api,{method:"POST",body:l},"$Aqepk0ZzjE");if(v.error.value)throw _=v.error.value,"";for(const R in r.value.items)r.value.items[R].id==l.id&&(r.value.items[R]=l);y.success("Enregistrement réussi"),l={}}catch(v){console.error(v),y.error("Nous n'avons pas pu effectuer l'opération demandée. Veuillez actualiser la page et réessayer.")}}async function q(){var l,i,_,v;if(s.destroy_function)s.destroy_function(r,k);else{const R=t.value.map(F=>F.id);let E;try{if(E=await T(s.destroy_route,{method:"DELETE",body:R},"$WCu8lI4Ak4"),E.data.value.error)throw"";if(E.error.value)((i=(l=E.error.value)==null?void 0:l.data)==null?void 0:i.message)==="Access interdit !"?y.error("Vous n'avez pas le droit d'éffectuer cette suppression !"):(v=(_=E.error.value)==null?void 0:_.data)!=null&&v.message.startsWith("Authentification requise !")&&y.error("Votre session est expirée, veuillez réactualiser la page !");else{let F=b.value.filter(Z=>!R.includes(Z.id));b.value=F,t.value=[],y.success("Réussite de la suppression ! ")}}catch{t.value=[],E.data.value.error?y.error(E.data.value.error):y.error()}}}return(l,i)=>{const _=m("v-btn"),v=m("v-tooltip"),R=m("v-icon"),E=m("v-card-text"),F=m("v-card-actions"),Z=m("v-card"),se=m("v-dialog"),I=m("v-col"),Q=m("v-row"),ie=m("v-text-field"),de=fe;return U(),J(ne,null,[G(N("input",{value:e.columns,onInput:i[0]||(i[0]=d=>l.$emit("update:columns",d.target.value))},null,40,pe),[[ae,!1]]),g(l.$slots,"top_form",{items:a(b),selected_object:a(k),selected:a(t),items_object:a(r),object_display_table:a(S)}),a(A)?(U(),M(Z,{key:0,class:"mx-2 my-2"},{default:o(()=>[n(E,null,{default:o(()=>[n(Q,null,{default:o(()=>[n(I,{cols:"12",style:{"text-align":"left"}},{default:o(()=>[e.add?(U(),M(Y,{key:0,selected:a(t),name_of_button:e.name_of_button_add?e.name_of_button_add:"Ajouter",disabled:e.func_controle_disabled_add_button?e.func_controle_disabled_add_button(a(t)):a(t).length!==0,icon_of_button:"mdi mdi-plus-outline",click_come_to_acess_update:e.click_come_to_acess_update},{button_text:o(d=>[g(l.$slots,"save_replacement",{item:d.item})]),button_button:o(d=>[n(_,{color:"black white--text",onClick:D=>j(d)},{default:o(()=>[V(" Enregistrer ")]),_:2},1032,["onClick"])]),_:3},8,["selected","name_of_button","disabled","click_come_to_acess_update"])):L("",!0),e.update?(U(),M(Y,{key:1,selected:a(t),disabled:e.func_controle_disabled_update_button?e.func_controle_disabled_update_button(a(t)):a(t).length!==1,name_of_button:e.name_of_button_edit?e.name_of_button_edit:"Modifier",icon_of_button:"mdi mdi-circle-edit-outline",click_come_to_acess_update:e.click_come_to_acess_update},{button_text:o(d=>[G(N("input",{id:"id","onUpdate:modelValue":D=>d.item.id=D,type:"hidden"},null,8,ye),[[re,d.item.id,void 0,{number:!0}]]),g(l.$slots,"edit_replacement",{item:d.item})]),button_button:o(d=>[n(_,{color:"black white--text",onClick:D=>$(d)},{default:o(()=>[V(" Enregistrer ")]),_:2},1032,["onClick"])]),_:3},8,["selected","disabled","name_of_button","click_come_to_acess_update"])):L("",!0),n(se,{transition:"dialog-bottom-transition",width:"auto"},{activator:o(({props:d})=>[e.destroy?(U(),M(_,ee({key:0},d,{class:"mr-1",style:{color:"white"},color:"#093e73",disabled:e.func_controle_disabled_delete_button?e.func_controle_disabled_delete_button(a(t)):!a(t).length}),{default:o(()=>[n(v,{activator:"parent",location:"top"},{default:o(()=>[V(O(e.name_of_button_delete?e.name_of_button_delete:"Supprimer"),1)]),_:1}),n(R,null,{default:o(()=>[V(" mdi mdi-delete-outline ")]),_:1}),N("span",he,O(e.name_of_button_delete?e.name_of_button_delete:"Supprimer"),1)]),_:2},1040,["disabled"])):L("",!0)]),default:o(({isActive:d})=>[n(Z,{width:"350"},{default:o(()=>[n(E,{class:"text-center"},{default:o(()=>[V(" Êtes-vous sûr ? "),we,V(" Vous ne pourrez pas revenir en arrière ! ")]),_:1}),ge,n(F,{class:"justify-center"},{default:o(()=>[n(_,{variant:"text",onClick:D=>d.value=!1},{default:o(()=>[V("Retour")]),_:2},1032,["onClick"]),n(_,{onClick:D=>{q(),d.value=!1},style:{color:"white","background-color":"red !important"}},{default:o(()=>[V(O(e.text_of_validation_on_pop_up_confirm_delete?e.text_of_validation_on_pop_up_confirm_delete:"OUI, SUPPRIMER!"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:3}),n(I,{cols:"12",class:"pa-0"},{default:o(()=>[g(l.$slots,"table_buttons",{items:a(b),selected_object:a(k),selected:a(t),items_object:a(r),object_display_table:a(S)})]),_:3}),n(I,{cols:"12"},{default:o(()=>[N("div",null,O(e.title),1)]),_:1})]),_:3})]),_:3}),N("div",ke,[n(Q,null,{default:o(()=>[n(I,{cols:"12",class:"pb-0"},{default:o(()=>[n(ie,{modelValue:a(z),"onUpdate:modelValue":i[1]||(i[1]=d=>W(z)?z.value=d:null),label:"Rechercher",class:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),n(I,{class:"d-flex justify-center pt-1 mb-5",cols:"12"},{default:o(()=>[n(_,{color:"#093e73",class:"text-white",onClick:C},{default:o(()=>[V("Rechercher")]),_:1})]),_:1})]),_:1})]),n(de,{with_selected:e.with_selected!=!1,selected:a(t),"onUpdate:selected":i[2]||(i[2]=d=>W(t)?t.value=d:null),items:a(b),"onUpdate:items":i[3]||(i[3]=d=>W(b)?b.value=d:b=d),header:e.columns,filter:a(p),"onUpdate:filter":i[4]||(i[4]=d=>W(p)?p.value=d:null),no_data:"Aucun élément trouvé.",no_data_to_search:"Aucun élément correspondant."},le({_:2},[K(a(w),d=>({name:`header(${d.key})`,fn:o(()=>[g(l.$slots,`header(${d.key})`)])})),K(a(w),d=>({name:`item(${d.active_modif_column?d.key:xe})`,fn:o(({item:D,elt_item:ue})=>[g(l.$slots,`cell(${d.key})`,{items_object:a(r),value:D,elt_item:ue,selected_object:a(k),object_display_table:a(S)})])}))]),1032,["with_selected","selected","items","header","filter"])]),_:3})):L("",!0)],64)}}},$e=je,Ve=["value"],Ue={__name:"TableUnitEditSave",props:["title","api","columns","update","add","destroy","destroy_route","add_function","update_function","item_will_be_send","click_come_to_acess_update","destroy_function","name_of_button_add","name_of_button_edit","name_of_button_delete","func_controle_disabled_add_button","func_controle_disabled_delete_button","func_controle_disabled_update_button","text_of_validation_on_pop_up_confirm_delete","with_selected"],emits:["update:columns"],setup(e){const u=e;c([]);const f=c([]);return oe(()=>{f.value=u.columns}),(s,w)=>(U(),J(ne,null,[G(N("input",{value:e.columns,onInput:w[0]||(w[0]=t=>s.$emit("update:columns",t.target.value))},null,40,Ve),[[ae,!1]]),n($e,{item_will_be_send:e.item_will_be_send,columns:e.columns,title:e.title,api:e.api,update:e.update,update_function:e.update_function,add:e.add,add_function:e.add_function,destroy:e.destroy,destroy_route:e.destroy_route,click_come_to_acess_update:e.click_come_to_acess_update,destroy_function:e.destroy_function,name_of_button_add:e.name_of_button_add,name_of_button_edit:e.name_of_button_edit,name_of_button_delete:e.name_of_button_delete,func_controle_disabled_add_button:e.func_controle_disabled_add_button,func_controle_disabled_delete_button:e.func_controle_disabled_delete_button,func_controle_disabled_update_button:e.func_controle_disabled_update_button,text_of_validation_on_pop_up_confirm_delete:e.text_of_validation_on_pop_up_confirm_delete,with_selected:e.with_selected},le({top_form:o(t=>[g(s.$slots,"top_form",{selected:t.selected,selected_object:t.selected_object,items:t.items,items_object:t.items_object,object_display_table:t.object_display_table})]),table_buttons:o(t=>[g(s.$slots,"table_buttons",{selected:t.selected,selected_object:t.selected_object,items:t.items,items_object:t.items_object,object_display_table:t.object_display_table})]),save_replacement:o(t=>[g(s.$slots,"default",{item:t.item})]),edit_replacement:o(t=>[g(s.$slots,"default",{item:t.item})]),_:2},[K(a(f),t=>({name:`header(${t.key})`,fn:o(()=>[g(s.$slots,`header(${t.key})`)])})),K(a(f),t=>({name:`cell(${t.key})`,fn:o(({value:k,items_object:b,selected_object:A,object_display_table:S,elt_item:y})=>[g(s.$slots,`cell(${t.key})`,{value:k,elt_item:y,items_object:b,selected_object:A,object_display_table:S})])}))]),1032,["item_will_be_send","columns","title","api","update","update_function","add","add_function","destroy","destroy_route","click_come_to_acess_update","destroy_function","name_of_button_add","name_of_button_edit","name_of_button_delete","func_controle_disabled_add_button","func_controle_disabled_delete_button","func_controle_disabled_update_button","text_of_validation_on_pop_up_confirm_delete","with_selected"])],64))}},Ae=Ue,Ce={key:0,class:"text-h5"},Ee={key:1,class:"text-h5"},Re={__name:"profils",async setup(e){let u,f;me({title:"Liste des profils"});let s=te(),w=c([]),t=c([]);({data:w}=([u,f]=H(()=>T("/api/users/profils","$LZifoD8c9P")),u=await u,f(),u)),{data:t}=([u,f]=H(()=>T("/api/users/permissions","$0ERabBRdGJ")),u=await u,f(),u);const k=c([{key:"name",text:"Nom",active_modif_column:!1}]),b=c("/api/users/profils");c(null);const A=c("Liste des profils");c(["Masculin","Féminin"]);const S=c("/api/users/profils");let y=c([{text:"Utilisateurs & profils",to:"/tableau-de-bord/utilisateurs-profils"},{text:"Profils"}]);async function B(p,C){var r,j,$,x;try{let h=await T("/api/users/profils",{method:"POST",body:p},"$ajQbpfFFRb");h.error.value?((j=(r=h.error.value)==null?void 0:r.data)==null?void 0:j.message)==="Access interdit !"?s.error("Vous n'avez pas le droit d'éffectuer cet ajout !"):(x=($=h.error.value)==null?void 0:$.data)!=null&&x.message.startsWith("Authentification requise !")&&s.error("Votre session est expirée, veuillez réactualiser la page !"):(C.value.items.push(p),s.success("Enregistrement réussi"))}catch{s.warning("Nous n'avons pas pu effectuer l'opération demandée. Veuillez actualiser la page et réessayer.")}}async function z(p,C){var r,j,$,x;try{let h=await T("/api/users/profils",{method:"POST",body:p},"$jcUtnP3qc7");if(h.error.value)((j=(r=h.error.value)==null?void 0:r.data)==null?void 0:j.message)==="Access interdit !"?s.error("Vous n'avez pas le droit d'éffectuer cette modification !"):(x=($=h.error.value)==null?void 0:$.data)!=null&&x.message.startsWith("Authentification requise !")&&s.error("Votre session est expirée, veuillez réactualiser la page !");else{for(const q in C.value.items)C.value.items[q].id==p.id&&(C.value.items[q]=p);s.success("Enregistrement réussi")}}catch{s.warning("Nous n'avons pas pu effectuer l'opération demandée. Veuillez actualiser la page et réessayer.")}}return(p,C)=>{const r=ce,j=m("v-card-title"),$=m("v-text-field"),x=m("v-autocomplete"),h=m("v-textarea"),q=m("v-card-text"),P=Ae,l=m("v-card");return U(),M(l,{class:"",style:{}},{default:o(()=>[n(r,{items:a(y)},null,8,["items"]),n(P,{api:a(b),title:a(A),update:!0,update_function:z,columns:a(k),add:!0,add_function:B,destroy:!0,destroy_route:a(S)},{default:o(i=>[n(j,{class:"d-flex justify-space-between"},{default:o(()=>[i.item.id?(U(),J("span",Ce,"Modifier un profil")):(U(),J("span",Ee,"Enregistrer un profil"))]),_:2},1024),n(q,{style:{overflow:"scroll"}},{default:o(()=>[n($,{modelValue:i.item.name,"onUpdate:modelValue":_=>i.item.name=_,label:"Profil *",rules:[_=>!!_||"Le nom du profil est obligatoire"],required:"",variant:"outlined",type:"text"},null,8,["modelValue","onUpdate:modelValue","rules"]),n(x,{modelValue:i.item.Permissions,"onUpdate:modelValue":_=>i.item.Permissions=_,items:a(t),"item-title":"name","item-value":"slug",label:"Permissions *","no-data-text":"Aucune donnée",rules:[_=>!!_||"Champ obligatoire"],multiple:"","closable-chips":"",chips:"","deletable-chips":"",variant:"outlined",auto:""},null,8,["modelValue","onUpdate:modelValue","items","rules"]),n(x,{modelValue:i.item.Roles,"onUpdate:modelValue":_=>i.item.Roles=_,items:a(w),"item-title":"name","item-value":"id",label:"Sous-profils ( les profils qui peuvent etre créés par ce profil )","no-data-text":"Aucune donnée",multiple:"","closable-chips":"",chips:"","deletable-chips":"",variant:"outlined",auto:""},null,8,["modelValue","onUpdate:modelValue","items"]),n(h,{label:"Description",variant:"outlined",modelValue:i.item.description,"onUpdate:modelValue":_=>i.item.description=_},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:1},8,["api","title","columns","destroy_route"])]),_:1})}}};export{Re as default};

import{u as P,r as n,c as w,a as t,b as m,d as S,e as o,f as c,w as h,g as I,o as M,h as a,i as N,n as g}from"./entry.febd1464.js";const B={id:"app"},$={id:"login"},q=o("div",{id:"description"},null,-1),O={id:"form"},T=o("div",{class:"mb-4",style:{"text-align":"center",color:"black"}},[o("h2",null,"Changement de mot de passe")],-1),U=o("br",null,null,-1),z={style:{"text-align":"center"}},E=o("span",{class:"d-xs-block",style:{color:"white"}},"Valider",-1),A={__name:"change-password",setup(F){let p=P();const y=function(){},l=n(!1),i=n(!1);n("");const v=n(!0),s=n({});n({});const f=n(null);w(()=>v.value?"fa-eye":"fa-eye-slash"),w(()=>v.value?"password":"text"),n("Ce champ est obligatoire");const{data:H,status:R,signIn:b,signOut:x}=t(),k=async({username:d,password:e})=>{const{error:u,url:_}=await b("credentials",{username:d,password:e,redirect:!1});if(!u)return t().data.value&&t().data.value.user&&t().data.value.user.is_change_password?g("/tableau-de-bord"):g("/change-password")};async function V(){try{const{valid:d}=await f.value.validate();if(d){s.value.username=t().data.value&&t().data.value.user&&t().data.value.user.username?t().data.value.user.username:"",s.value.id=t().data.value&&t().data.value.user&&t().data.value.user.id?t().data.value.user.id:"";let e=await N("/api/changePassword",{method:"POST",body:{...s.value}},"$wfdi3Ru8Pn");e.data.value.status==200?(p.success("Mot de passe changé avec succès."),await x({redirect:!1}),await k({username:s.value.username,password:s.value.password})):e.data.value.message&&p.error(e.data.value.message)}}catch{p.error("Nous n'avons pas pu effectuer l'opération demandée. Veuillez actualiser la page et réessayer.")}}return(d,e)=>{const u=m("v-text-field"),_=m("v-btn"),C=m("v-form");return M(),S("div",null,[o("div",B,[o("div",$,[q,o("div",O,[T,c(C,{onSubmit:I(y,["prevent"]),ref_key:"form",ref:f},{default:h(()=>[c(u,{"prepend-icon":"mdi-lock-outline",label:"Nouveau mot de passe *",modelValue:a(s).password,"onUpdate:modelValue":e[0]||(e[0]=r=>a(s).password=r),modelModifiers:{trim:!0},outlined:"","append-inner-icon":a(l)?"mdi-eye":"mdi-eye-off",type:a(l)?"text":"password","onClick:appendInner":e[1]||(e[1]=r=>l.value=!a(l)),required:""},null,8,["modelValue","append-inner-icon","type"]),c(u,{"prepend-icon":"mdi-lock-outline",label:"Confirmation de mot de passe *",modelValue:a(s).confirm_password,"onUpdate:modelValue":e[2]||(e[2]=r=>a(s).confirm_password=r),modelModifiers:{trim:!0},outlined:"","append-inner-icon":a(i)?"mdi-eye":"mdi-eye-off",type:a(i)?"text":"password","onClick:appendInner":e[3]||(e[3]=r=>i.value=!a(i)),required:""},null,8,["modelValue","append-inner-icon","type"]),U,o("div",z,[c(_,{class:"white--text",onClick:V,style:{color:"white","background-color":"#093e73",width:"200px","margin-bottom":"10px"},rounded:"",href:"",disabled:a(s).password!=a(s).confirm_password||a(s).password==""},{default:h(()=>[E]),_:1},8,["disabled"])])]),_:1},512)])])])])}}};export{A as default};
